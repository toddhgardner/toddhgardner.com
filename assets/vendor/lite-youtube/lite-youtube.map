{"version":3,"sources":["jsdelivr-header.js","/npm/@justinribeiro/lite-youtube@0.6.2/lite-youtube.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA,ACUA,MAAM,oBAAoB,YACxB,cACE,QACA,KAAK,gBAAiB,EACtB,KAAK,aAGP,gCACE,MAAO,CAAC,WAGV,oBACE,KAAK,iBAAiB,cAAe,YAAY,gBAAiB,CAChE,MAAM,IAGR,KAAK,iBAAiB,QAAS,GAAK,KAAK,eAO3C,aACoB,KAAK,aAAa,CAAC,KAAM,SACjC,UAAY,2jFAuFtB,KAAK,cAAgB,KAAK,WAAW,cAAc,UACnD,KAAK,YAAc,CACjB,SAAU,KAAK,WAAW,cAAc,wBACxC,KAAM,KAAK,WAAW,cAAc,oBACpC,KAAM,KAAK,WAAW,cAAc,qBAEtC,KAAK,mBAAqB,KAAK,WAAW,cAAc,gBAO1D,mBACE,KAAK,QAAU,mBAAmB,KAAK,aAAa,YACpD,KAAK,WAAa,KAAK,aAAa,eAAiB,QACrD,KAAK,UAAY,KAAK,aAAa,cAAgB,OACnD,KAAK,aAAe,KAAK,aAAa,UAAY,EAClD,KAAK,SAA6C,KAAlC,KAAK,aAAa,YAElC,KAAK,yBAEL,KAAK,mBAAmB,aACtB,gBACG,KAAK,cAAc,KAAK,cAE7B,KAAK,aAAa,WAAY,KAAK,cAAc,KAAK,cAElD,KAAK,UACP,KAAK,6BAUT,yBAAyB,EAAM,EAAQ,GACrC,OAAQ,GACN,IAAK,UACC,IAAW,IACb,KAAK,mBAGD,KAAK,cAAc,UAAU,SAAS,mBACxC,KAAK,cAAc,UAAU,OAAO,iBACpC,KAAK,WAAW,cAAc,UAAU,YAclD,cACE,IAAK,KAAK,eAAgB,CACxB,MAAM,wKAG2B,KAAK,4BAA4B,KAAK,4BAEvE,KAAK,cAAc,mBAAmB,YAAa,GACnD,KAAK,cAAc,UAAU,IAAI,iBACjC,KAAK,gBAAiB,GAQ1B,yBAEE,YAAY,YAAY,aAAc,wBAEtC,MAAM,iCAA+C,KAAK,yBACpD,4BAA0C,KAAK,wBACrD,KAAK,YAAY,KAAK,OAAS,EAC/B,KAAK,YAAY,KAAK,OAAS,EAC/B,KAAK,YAAY,SAAS,IAAM,EAChC,KAAK,YAAY,SAAS,aACxB,gBACG,KAAK,cAAc,KAAK,cAE7B,KAAK,YAAY,SAAS,aACxB,SACG,KAAK,cAAc,KAAK,cAQ/B,6BACE,GACE,yBAA0B,QAC1B,8BAA+B,OAC/B,CAOiB,IAAI,qBAAqB,CAAC,EAAS,KAClD,EAAQ,QAAQ,IACV,EAAM,iBAAmB,KAAK,iBAChC,YAAY,kBACZ,KAAK,cACL,EAAS,UAAU,UAXT,CACd,KAAM,KACN,WAAY,MACZ,UAAW,IAaJ,QAAQ,OAOrB,mBAAmB,EAAM,EAAK,GAC5B,MAAM,EAAW,SAAS,cAAc,QACxC,EAAS,IAAM,EACf,EAAS,KAAO,EACZ,IACF,EAAS,GAAK,GAEhB,EAAS,aAAc,EACvB,SAAS,KAAK,OAAO,GAavB,yBACM,YAAY,eAEhB,YAAY,YAAY,aAAc,uBAItC,YAAY,YAAY,aAAc,2BAGtC,YAAY,YAAY,aAAc,0BAItC,YAAY,YACV,aACA,uCAEF,YAAY,YAAY,aAAc,kCACtC,YAAY,cAAe,IAI/B,eAAe,OAAO,eAAgB","file":"/npm/@justinribeiro/lite-youtube@0.6.2/lite-youtube.js","sourceRoot":"","sourcesContent":["/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/@justinribeiro/lite-youtube@0.6.2/lite-youtube.js\n * \n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n","/**\n *\n * The shadowDom / Intersection Observer version of Paul's concept:\n * https://github.com/paulirish/lite-youtube-embed\n *\n * A lightweight YouTube embed. Still should feel the same to the user, just\n * MUCH faster to initialize and paint.\n *\n * Thx to these as the inspiration\n *   https://storage.googleapis.com/amp-vs-non-amp/youtube-lazy.html\n *   https://autoplay-youtube-player.glitch.me/\n *\n * Once built it, I also found these (👍👍):\n *   https://github.com/ampproject/amphtml/blob/master/extensions/amp-youtube\n *   https://github.com/Daugilas/lazyYT https://github.com/vb/lazyframe\n */\nclass LiteYTEmbed extends HTMLElement {\n  constructor() {\n    super();\n    this.__iframeLoaded = false;\n    this.__setupDom();\n  }\n\n  static get observedAttributes() {\n    return ['videoid'];\n  }\n\n  connectedCallback() {\n    this.addEventListener('pointerover', LiteYTEmbed.warmConnections, {\n      once: true,\n    });\n\n    this.addEventListener('click', e => this.__addIframe());\n  }\n\n  /**\n   * Define our shadowDOM for the component\n   * @private\n   */\n  __setupDom() {\n    const shadowDom = this.attachShadow({mode: 'open'});\n    shadowDom.innerHTML = `\n      <style>\n        :host {\n          contain: content;\n          display: block;\n          position: relative;\n          width: 100%;\n          padding-bottom: calc(100% / (16 / 9));\n        }\n\n        #frame, #fallbackPlaceholder, iframe {\n          position: absolute;\n          width: 100%;\n          height: 100%;\n        }\n\n        #frame {\n          cursor: pointer;\n        }\n\n        #fallbackPlaceholder {\n          object-fit: cover;\n        }\n\n        #frame::before {\n          content: '';\n          display: block;\n          position: absolute;\n          top: 0;\n          background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==);\n          background-position: top;\n          background-repeat: repeat-x;\n          height: 60px;\n          padding-bottom: 50px;\n          width: 100%;\n          transition: all 0.2s cubic-bezier(0, 0, 0.2, 1);\n          z-index: 1;\n        }\n        /* play button */\n        .lty-playbtn {\n          width: 70px;\n          height: 46px;\n          background-color: #212121;\n          z-index: 1;\n          opacity: 0.8;\n          border-radius: 14%; /* TODO: Consider replacing this with YT's actual svg. Eh. */\n          transition: all 0.2s cubic-bezier(0, 0, 0.2, 1);\n          border: 0;\n        }\n        #frame:hover .lty-playbtn {\n          background-color: #f00;\n          opacity: 1;\n        }\n        /* play button triangle */\n        .lty-playbtn:before {\n          content: '';\n          border-style: solid;\n          border-width: 11px 0 11px 19px;\n          border-color: transparent transparent transparent #fff;\n        }\n        .lty-playbtn,\n        .lty-playbtn:before {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate3d(-50%, -50%, 0);\n        }\n\n        /* Post-click styles */\n        .lyt-activated {\n          cursor: unset;\n        }\n\n        #frame.lyt-activated::before,\n        .lyt-activated .lty-playbtn {\n          display: none;\n        }\n      </style>\n      <div id=\"frame\">\n        <picture>\n          <source id=\"webpPlaceholder\" type=\"image/webp\">\n          <source id=\"jpegPlaceholder\" type=\"image/jpeg\">\n          <img id=\"fallbackPlaceholder\" referrerpolicy=\"origin\">\n        </picture>\n        <button class=\"lty-playbtn\"></button>\n      </div>\n    `;\n    this.__domRefFrame = this.shadowRoot.querySelector('#frame');\n    this.__domRefImg = {\n      fallback: this.shadowRoot.querySelector('#fallbackPlaceholder'),\n      webp: this.shadowRoot.querySelector('#webpPlaceholder'),\n      jpeg: this.shadowRoot.querySelector('#jpegPlaceholder'),\n    };\n    this.__domRefPlayButton = this.shadowRoot.querySelector('.lty-playbtn');\n  }\n\n  /**\n   * Parse our attributes and fire up some placeholders\n   * @private\n   */\n  __setupComponent() {\n    this.videoId = encodeURIComponent(this.getAttribute('videoid'));\n    this.videoTitle = this.getAttribute('videotitle') || 'Video';\n    this.videoPlay = this.getAttribute('videoplay') || 'Play';\n    this.videoStartAt = this.getAttribute('start') || 0;\n    this.autoLoad = this.getAttribute('autoload') === '' ? true : false;\n\n    this.__initImagePlaceholder();\n\n    this.__domRefPlayButton.setAttribute(\n      'aria-label',\n      `${this.videoPlay}: ${this.videoTitle}`,\n    );\n    this.setAttribute('title', `${this.videoPlay}: ${this.videoTitle}`);\n\n    if (this.autoLoad) {\n      this.__initIntersectionObserver();\n    }\n  }\n\n  /**\n   * Lifecycle method that we use to listen for attribute changes to period\n   * @param {*} name\n   * @param {*} oldVal\n   * @param {*} newVal\n   */\n  attributeChangedCallback(name, oldVal, newVal) {\n    switch (name) {\n      case 'videoid': {\n        if (oldVal !== newVal) {\n          this.__setupComponent();\n\n          // if we have a previous iframe, remove it and the activated class\n          if (this.__domRefFrame.classList.contains('lyt-activated')) {\n            this.__domRefFrame.classList.remove('lyt-activated');\n            this.shadowRoot.querySelector('iframe').remove();\n          }\n        }\n        break;\n      }\n      default:\n        break;\n    }\n  }\n\n  /**\n   * Inject the iframe into the component body\n   * @private\n   */\n  __addIframe() {\n    if (!this.__iframeLoaded) {\n      const iframeHTML = `\n<iframe frameborder=\"0\"\n  allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen\n  src=\"https://www.youtube.com/embed/${this.videoId}?autoplay=1&start=${this.videoStartAt}\"\n></iframe>`;\n      this.__domRefFrame.insertAdjacentHTML('beforeend', iframeHTML);\n      this.__domRefFrame.classList.add('lyt-activated');\n      this.__iframeLoaded = true;\n    }\n  }\n\n  /**\n   * Setup the placeholder image for the component\n   * @private\n   */\n  __initImagePlaceholder() {\n    // we don't know which image type to preload, so warm the connection\n    LiteYTEmbed.addPrefetch('preconnect', 'https://i.ytimg.com/');\n\n    const posterUrlWebp = `https://i.ytimg.com/vi_webp/${this.videoId}/hqdefault.webp`;\n    const posterUrlJpeg = `https://i.ytimg.com/vi/${this.videoId}/hqdefault.jpg`;\n    this.__domRefImg.webp.srcset = posterUrlWebp;\n    this.__domRefImg.jpeg.srcset = posterUrlJpeg;\n    this.__domRefImg.fallback.src = posterUrlJpeg;\n    this.__domRefImg.fallback.setAttribute(\n      'aria-label',\n      `${this.videoPlay}: ${this.videoTitle}`,\n    );\n    this.__domRefImg.fallback.setAttribute(\n      'alt',\n      `${this.videoPlay}: ${this.videoTitle}`,\n    );\n  }\n\n  /**\n   * Setup the Intersection Observer to load the iframe when scrolled into view\n   * @private\n   */\n  __initIntersectionObserver() {\n    if (\n      'IntersectionObserver' in window &&\n      'IntersectionObserverEntry' in window\n    ) {\n      const options = {\n        root: null,\n        rootMargin: '0px',\n        threshold: 0,\n      };\n\n      const observer = new IntersectionObserver((entries, observer) => {\n        entries.forEach(entry => {\n          if (entry.isIntersecting && !this.__iframeLoaded) {\n            LiteYTEmbed.warmConnections();\n            this.__addIframe();\n            observer.unobserve(this);\n          }\n        });\n      }, options);\n\n      observer.observe(this);\n    }\n  }\n\n  /**\n   * Add a <link rel={preload | preconnect} ...> to the head\n   */\n  static addPrefetch(kind, url, as) {\n    const linkElem = document.createElement('link');\n    linkElem.rel = kind;\n    linkElem.href = url;\n    if (as) {\n      linkElem.as = as;\n    }\n    linkElem.crossorigin = true;\n    document.head.append(linkElem);\n  }\n\n  /**\n   * Begin preconnecting to warm up the iframe load Since the embed's netwok\n   * requests load within its iframe, preload/prefetch'ing them outside the\n   * iframe will only cause double-downloads. So, the best we can do is warm up\n   * a few connections to origins that are in the critical path.\n   *\n   * Maybe `<link rel=preload as=document>` would work, but it's unsupported:\n   * http://crbug.com/593267 But TBH, I don't think it'll happen soon with Site\n   * Isolation and split caches adding serious complexity.\n   */\n  static warmConnections() {\n    if (LiteYTEmbed.preconnected) return;\n    // Host that YT uses to serve JS needed by player, per amp-youtube\n    LiteYTEmbed.addPrefetch('preconnect', 'https://s.ytimg.com');\n\n    // The iframe document and most of its subresources come right off\n    // youtube.com\n    LiteYTEmbed.addPrefetch('preconnect', 'https://www.youtube.com');\n\n    // The botguard script is fetched off from google.com\n    LiteYTEmbed.addPrefetch('preconnect', 'https://www.google.com');\n\n    // TODO: Not certain if these ad related domains are in the critical path.\n    // Could verify with domain-specific throttling.\n    LiteYTEmbed.addPrefetch(\n      'preconnect',\n      'https://googleads.g.doubleclick.net',\n    );\n    LiteYTEmbed.addPrefetch('preconnect', 'https://static.doubleclick.net');\n    LiteYTEmbed.preconnected = true;\n  }\n}\n// Register custom element\ncustomElements.define('lite-youtube', LiteYTEmbed);\n"]}